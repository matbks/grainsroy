sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","../model/formatter","sap/m/library"],function(e,t,i,n){"use strict";var s=n.URLHelper;return e.extend("grains.zadograinsacmcontrollingapproval.controller.Detail",{formatter:i,onInit:functio+
n(){var e=new t({busy:false,delay:0,lineItemListTitle:this.getResourceBundle().getText("detailLineItemTableHeading")});this.getRouter().getRoute("object").attachPatternMatched(this._onObjectMatched,this);this.setModel(e,"detailView");this.getOwnerCompone+
nt().getModel().metadataLoaded().then(this._onMetadataLoaded.bind(this));var i=new sap.ui.core.message.ControlMessageProcessor;this._oMessageManager=sap.ui.getCore().getMessageManager();this._oMessageManager.registerMessageProcessor(i)},onListUpdateFinis+
hed:function(e){var t,i=e.getParameter("total"),n=this.getModel("detailView");if(this.byId("lineItemsList").getBinding("items").isLengthFinal()){if(i){t=this.getResourceBundle().getText("detailLineItemTableHeadingCount",[i])}else{t=this.getResourceBundle+
().getText("detailLineItemTableHeading")}n.setProperty("/lineItemListTitle",t)}},onApprovePress:function(e){this._setStatus(e,"T")},onRejectPress:function(e){this._setStatus(e,"S")},onReversePress:function(e){this._setStatus(e,"U")},onBeforeRebindSmartli+
st:function(e){var t=e.getParameter("bindingParams");if(!t.sorter.length){t.sorter.push(new sap.ui.model.Sorter("CreatedOn",true))}},_setStatus:function(e,t){var i=e.getSource().getBindingContext().getObject().TradingContractNumber;var n=e.getSource().ge+
tBindingContext().getObject().ContractPlant;var s=this.byId("SmartListHistory");var o=[{trading_contract_number:i,plant:n,new_status:t}];var a={Action:"SETSTATUS",StructureName:"ZADOS_GRAINS_SET_CONTR_STATUS",Json:JSON.stringify(o)};var r=this.getModel("+
detailView");r.setProperty("/busy",true);this.JsonCommunication(a).then(function(e,t){s.rebindList();this.getView().getModel().refresh();r.setProperty("/busy",false)}.bind(this))},_onObjectMatched:function(e){var t={ObjectId:e.getParameter("arguments").o+
bjectId,ObjectFixation:e.getParameter("arguments").objectFixation,Type:e.getSource().getPattern().split("/")[0]};this.getModel("appView").setProperty("/layout","TwoColumnsMidExpanded");this.getModel().metadataLoaded().then(function(){var e=this.getModel(+
).createKey("ZADOC_GRAINS_APPROVAL_LIST",{TradingContractNumber:t.ObjectId,Type:t.Type,IdentificationFix:t.ObjectFixation});this._bindView("/"+e)}.bind(this))},_bindView:function(e){var t=this.getModel("detailView");t.setProperty("/busy",false);this.getV+
iew().bindElement({path:e,events:{change:this._onBindingChange.bind(this),dataRequested:function(){t.setProperty("/busy",true)},dataReceived:function(){t.setProperty("/busy",false)}}})},_onBindingChange:function(){var e=this.getView(),t=e.getElementBindi+
ng();if(!t.getBoundContext()){this.getRouter().getTargets().display("detailObjectNotFound");this.getOwnerComponent().oListSelector.clearMasterListSelection();return}var i=t.getPath(),n=this.getResourceBundle(),s=e.getModel().getObject(i),o=s.TradingContr+
actNumber,a=s.TradingContractNumber,r=this.getModel("detailView");this.getOwnerComponent().oListSelector.selectAListItem(i);sap.ui.getCore().getMessageManager().removeAllMessages()},_onMetadataLoaded:function(){var e=this.getView().getBusyIndicatorDelay(+
),t=this.getModel("detailView"),i=this.byId("lineItemsList");t.setProperty("/delay",0);t.setProperty("/lineItemTableDelay",0);t.setProperty("/busy",true);t.setProperty("/delay",e)},onCloseDetailPress:function(){this.getModel("appView").setProperty("/acti+
onButtonsInfo/midColumn/fullScreen",false);var e=this.getOwnerComponent().oListSelector;e.clearMasterListSelection();this.getRouter().navTo("list");sap.ui.getCore().getMessageManager().removeAllMessages()},toggleFullScreen:function(){var e=this.getModel(+
"appView").getProperty("/actionButtonsInfo/midColumn/fullScreen");this.getModel("appView").setProperty("/actionButtonsInfo/midColumn/fullScreen",!e);if(!e){this.getModel("appView").setProperty("/previousLayout",this.getModel("appView").getProperty("/layo+
ut"));this.getModel("appView").setProperty("/layout","MidColumnFullScreen")}else{this.getModel("appView").setProperty("/layout",this.getModel("appView").getProperty("/previousLayout"))}}})});                                                                