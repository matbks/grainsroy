sap.ui.define([                                                                                                                                                                                                                                                
    "./BaseController",                                                                                                                                                                                                                                        
    "sap/m/Switch",                                                                                                                                                                                                                                            
    "sap/ui/model/Filter",                                                                                                                                                                                                                                     
    "sap/ui/model/FilterOperator",                                                                                                                                                                                                                             
], function (                                                                                                                                                                                                                                                  
    BaseController,                                                                                                                                                                                                                                            
    Switch,                                                                                                                                                                                                                                                    
    Filter,                                                                                                                                                                                                                                                    
    FilterOperator                                                                                                                                                                                                                                             
) {                                                                                                                                                                                                                                                            
    "use strict";                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
    return BaseController.extend("grains.zadograinsacmcontrollingapproval.controller.Report", {                                                                                                                                                                
                                                                                                                                                                                                                                                               
        onInit: function () {                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        onBeforeRebindSmartTableReport: function (oEvent) {                                                                                                                                                                                                    
            var oSmartFilterBar = this.byId(oEvent.getSource().getSmartFilterId());                                                                                                                                                                            
                                                                                                                                                                                                                                                               
            var oBindingParams = oEvent.getParameter("bindingParams");                                                                                                                                                                                         
            if (!oBindingParams.sorter.length) {                                                                                                                                                                                                               
                oBindingParams.sorter.push(new sap.ui.model.Sorter("CreatedOn", true));                                                                                                                                                                        
            };                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            var oComboBox = oSmartFilterBar.getControlByKey("Type");                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
            var aSelectedKeys = oComboBox.getSelectedKeys();                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
            aSelectedKeys.forEach((filter) => {                                                                                                                                                                                                                
                var newFilter = new Filter("Type", FilterOperator.EQ, filter);                                                                                                                                                                                 
                oBindingParams.filters.push(newFilter);                                                                                                                                                                                                        
            });                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
        formatRowHighlight: function (MessageNumber) {                                                                                                                                                                                                         
            switch (MessageNumber) {                                                                                                                                                                                                                           
                case '002':                                                                                                                                                                                                                                    
                    return "Success";                                                                                                                                                                                                                          
                case '014':                                                                                                                                                                                                                                    
                    return "Success";                                                                                                                                                                                                                          
                case '004':                                                                                                                                                                                                                                    
                    return "Warning";                                                                                                                                                                                                                          
                case '006':                                                                                                                                                                                                                                    
                    return "Warning";                                                                                                                                                                                                                          
                case '003':                                                                                                                                                                                                                                    
                    return "Error";                                                                                                                                                                                                                            
                case '005':                                                                                                                                                                                                                                    
                    return "Error";                                                                                                                                                                                                                            
                case '015':                                                                                                                                                                                                                                    
                    return "Error";                                                                                                                                                                                                                            
                case '016':                                                                                                                                                                                                                                    
                    return "Error";                                                                                                                                                                                                                            
                default:                                                                                                                                                                                                                                       
                    return "None";                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
        onRowPress: function (oEvent) {                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
            var oModel = this.getView().getModel();                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
            var oObject = oEvent.getSource().getSelectedItem().getBindingContext().getObject();                                                                                                                                                                
                                                                                                                                                                                                                                                               
            if (oObject.NewStatus != 'S') {                                                                                                                                                                                                                    
                return;                                                                                                                                                                                                                                        
            };                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            var sTitle = this.getResourceBundle().getText("rejectReason");                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
            var oBeginButton;                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
            var oEndButton = new sap.m.Button({                                                                                                                                                                                                                
                text: "Ok",                                                                                                                                                                                                                                    
                press: function (oEvent) {                                                                                                                                                                                                                     
                    this.oDefaultDialog.close();                                                                                                                                                                                                               
                }.bind(this)                                                                                                                                                                                                                                   
            })                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            oModel.read("/ZADOC_GRAINS_TXT('" + oObject.Guid + "')", {                                                                                                                                                                                         
                success: function (oData, oResponse) {                                                                                                                                                                                                         
                    var oVbox = new sap.m.VBox({ items: [new sap.m.Text(this.getView().createId("textRejectReason"), { text: oData.Text })] });                                                                                                                
                    oVbox.addStyleClass("sapUiSmallMargin");                                                                                                                                                                                                   
                    this.onCreateDialog(sTitle, oVbox, oBeginButton, oEndButton, "700px");                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                }.bind(this),                                                                                                                                                                                                                                  
                error: function (oError) {                                                                                                                                                                                                                     
                    this.submitError(oError.responseText)                                                                                                                                                                                                      
                }.bind(this)                                                                                                                                                                                                                                   
            });                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
    });                                                                                                                                                                                                                                                        
});                                                                                                                                                                                                                                                            