sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/fe/navigation/ParamHandlingMode"],function(e,t,n){"use strict";return e.extend("grains.zadograinsacmcontrollingclearingacc.controller.BaseController",{getRouter:function(){ret+
urn this.getOwnerComponent().getRouter()},getModel:function(e){return this.getView().getModel(e)},setModel:function(e,t){return this.getView().setModel(e,t)},getResourceBundle:function(){return this.getOwnerComponent().getModel("i18n").getResourceBundle(+
)},onNavBack:function(){var e=t.getInstance().getPreviousHash();if(e!==undefined){history.go(-1)}else{this.getRouter().navTo("list",{},true)}},onMessagesButtonPress:function(e){var t=this;try{var n=e.getSource()}catch(t){var n=e}if(!this._messagePopover)+
{this._messagePopover=new sap.m.MessagePopover({headerButton:new sap.m.Button({type:sap.m.ButtonType.Reject,icon:"sap-icon://delete",press:function(){this._messagePopover.close();sap.ui.getCore().getMessageManager().removeAllMessages()}.bind(this)}),item+
s:{path:"message>/",template:new sap.m.MessageItem({description:"{message>description}",type:"{message>type}",title:"{message>message}",subtitle:"{message>additionalText}",description:"{message>description}"})}});n.addDependent(this._messagePopover)}this+
._messagePopover.toggle(n)},JsonCommunication:function(e){return new Promise(function(t,n){var o=this.getModel("detailView");var r=this.getView().getModel();r.create("/JsonCommunicationSet",e,{success:function(e,n){setTimeout(function(){var e=this.byId("+
MessageIndicator");this.onMessagesButtonPress(e)}.bind(this),100);o.setProperty("/busy",false);t()}.bind(this),error:function(e){setTimeout(function(){var e=this.byId("MessageIndicator");this.onMessagesButtonPress(e)}.bind(this),100);o.setProperty("/busy+
",false);n()}.bind(this)})}.bind(this))},_getAccountingDocumentTree:function(e){var t=this.getView().getModel();var n=[new sap.ui.model.Filter({path:"CompanyCode",operator:sap.ui.model.FilterOperator.EQ,value1:e.InvoiceCompanyCode}),new sap.ui.model.Filt+
er({path:"AccountingDocument",operator:sap.ui.model.FilterOperator.EQ,value1:e.AccountingDocument}),new sap.ui.model.Filter({path:"AccountingDocumentYear",operator:sap.ui.model.FilterOperator.EQ,value1:e.AccountingDocumentYear}),new sap.ui.model.Filter({+
path:"AccountingItem",operator:sap.ui.model.FilterOperator.EQ,value1:e.AccountingItem})];t.read("/AccountingDocumentTreeSet",{filters:n,success:function(e,t){var n=this._transformTreeData(e.results);this._setNodesModelData(n)}.bind(this),error:function(e+
){}.bind(this)})},_transformTreeData:function(e){var t=[];var n={};if(e){var o;var r;for(var i=0;i<e.length;i++){var s=e[i];o={NodeId:s.NodeId,ParentNodeId:s.ParentNodeId,HierarchyLevel:s.HierarchyLevel,DrillState:s.DrillState,AccountingDocument:s.Accoun+
tingDocument,AccountingDocumentYear:s.AccountingDocumentYear,AccountingItem:s.AccountingItem,Amount:s.Amount,Currency:s.Currency,Status:s.Status,ClearingDocumentYear:s.ClearingDocumentYear,ClearingDocument:s.ClearingDocument,Description:s.Description,chi+
ldren:[]};r=s.ParentNodeId;if(r&&r>0){var a=n[s.ParentNodeId];var c=a.children.length+1;o.Description=a.Description+"."+c;if(a){a.children.push(o)}}else{t.push(o)}n[o.NodeId]=o}}return t},_setNodesModelData:function(e){var t=this.getOwnerComponent().getM+
odel("nodeModel");var n=this.byId("treeTable");if(t){t.setData({nodeRoot:{children:e}});t.refresh()}else{var o=new sap.ui.model.json.JSONModel;o.setData({nodeRoot:{children:e}});this.getOwnerComponent().setModel(o,"nodeModel")}if(n){n.refreshRows();n.exp+
andToLevel(1)}else{var n=this.getOwnerComponent().byId("detailDetail--treeTable");n.refreshRows();n.expandToLevel(1)}},onTreeTableRefresh:function(){var e=this.byId("tableInvoiceItems");if(e){if(e.getSelectedItem()){var t=e.getSelectedItem().getBindingCo+
ntext().getObject()}else{return}}else{var t=this.getView().getBindingContext().getObject()}this._getAccountingDocumentTree(t)},callTransaction(e,t,n){var o=sap.ushell.Container.getService("CrossApplicationNavigation");var r=o.hrefForExternal({target:{sem+
anticObject:e,action:t},params:n});window.location.href=r}})});                                                                                                                                                                                                