sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/model/FilterOperator","sap/m/GroupHeaderListItem","sap/ui/Device","sap/ui/core/Fragment","../model/formatter"],function(t,e,i,r,n,s,o,a,l)+
{"use strict";return t.extend("grains.zadograinsacmcontrollingclearingacc.controller.List",{formatter:l,onInit:function(){var t=this.byId("list"),e=this._createViewModel(),i=t.getBusyIndicatorDelay();this._oGroupFunctions={TradingContract:function(t){var+
 e=t.getProperty("TradingContract");return{key:e,text:this.getResourceBundle().getText("contractNumber",[e])}}.bind(this),InvoicePartner:function(t){var e=t.getProperty("InvoicePartner");return{key:e,text:this.getResourceBundle().getText("invoicePartner"+
,[e])}}.bind(this)};this._oList=t;this._oListFilterState={aFilter:[],aSearch:[]};this.setModel(e,"listView");t.attachEventOnce("updateFinished",function(){e.setProperty("/delay",i)});this.getView().addEventDelegate({onBeforeFirstShow:function(){this.getO+
wnerComponent().oListSelector.setBoundMasterList(t)}.bind(this)});this.getRouter().getRoute("list").attachPatternMatched(this._onMasterMatched,this);this.getRouter().attachBypassed(this.onBypassed,this)},onUpdateFinished:function(t){this._updateListItemC+
ount(t.getParameter("total"));this._selectItemFromURLParameters()},_selectItemFromURLParameters:function(){var t=this.byId("segmentedButtonStatus");var e=this.getOwnerComponent().getModel("actualSettlementInvoice");var i=e.getData();if(!e){return}if(!i.T+
radingContract){i.isInicialized=true;e.refresh();return}var r=this.getView().getModel();var n=r.createKey("/ZADOC_GRAINS_CTR_APP_INV_SD",{TradingContract:i.TradingContract,AbdNumber:i.AbdNumber});var s=this.getModel("listView");if(!i.isInicialized){r.rea+
d(n,{success:function(r){if(t.getSelectedKey()!==r.AccountingDocumentStatus){t.setSelectedKey(r.AccountingDocumentStatus);this.onStatusChange()}else{this.getOwnerComponent().oListSelector.selectAListItem(n)}i.isInicialized=true;e.refresh()}.bind(this),er+
ror:function(t){console.log(t)}.bind(this)})}else{this.getOwnerComponent().oListSelector.selectAListItem(n)}},onSearch:function(t){if(t.getParameters().refreshButtonPressed){this.onRefresh();return}var e=t.getParameter("query");if(e){var i=["TradingContr+
act","TradingContractType","SettlementGroupId","InvoicePartner","InvoicePartnerName","InvoiceCompanyCode","CompanyCodeName","InvoiceDoc","AccountingDocument"];var r=[];i.forEach(function(t){var i=new sap.ui.model.Filter({path:t,operator:sap.ui.model.Filt+
erOperator.Contains,value1:e});r.push(i)});var n=new sap.ui.model.Filter({filters:r,and:false});this._oListFilterState.aSearch=[n]}else{this._oListFilterState.aSearch=[]}this._applyFilterSearch()},onStatusChange:function(){var t=this.getModel("listView")+
;var e=this.byId("segmentedButtonStatus").getSelectedKey();var i=new sap.ui.model.Filter({path:"AccountingDocumentStatus",operator:sap.ui.model.FilterOperator.EQ,value1:e});this._oListFilterState.aFilter=[i];t.setProperty("/selectedStatus",e);var r=[];r.+
push(this.getResourceBundle().getText(e));this._updateFilterBar(r.join(", "));this._applyFilterSearch()},onRefresh:function(){this._oList.getBinding("items").refresh()},onOpenViewSettings:function(t){var e="filter";if(t.getSource()instanceof sap.m.Button+
){var i=t.getSource().getId();if(i.match("sort")){e="sort"}else if(i.match("group")){e="group"}}if(!this.byId("viewSettingsDialog")){a.load({id:this.getView().getId(),name:"grains.zadograinsacmcontrollingclearingacc.view.ViewSettingsDialog",controller:th+
is}).then(function(t){this.getView().addDependent(t);t.addStyleClass(this.getOwnerComponent().getContentDensityClass());this._setSelectedFilter();t.open(e)}.bind(this))}else{this._setSelectedFilter();this.byId("viewSettingsDialog").open(e)}},_setSelected+
Filter:function(){var t=this.getModel("listView");var e=t.getProperty("/selectedStatus");this.byId(e).setSelected(true)},onConfirmViewSettingsDialog:function(t){var e=t.getParameters().filterItems,r=[],s=[],o=this.byId("segmentedButtonStatus");e.forEach(+
function(t){r.push(new i("AccountingDocumentStatus",n.EQ,t.getKey()));s.push(t.getText());o.setSelectedKey(t.getKey())}.bind(this));this._oListFilterState.aFilter=r;this._updateFilterBar(s.join(", "));this._applyFilterSearch();this._applySortGroup(t)},_a+
pplySortGroup:function(t){var e=t.getParameters(),i,n,s=[];if(e.groupItem){i=e.groupItem.getKey();n=e.groupDescending;var o=this._oGroupFunctions[i];s.push(new r(i,n,o))}i=e.sortItem.getKey();n=e.sortDescending;s.push(new r(i,n));this._oList.getBinding("+
items").sort(s)},onSelectionChange:function(t){var e=t.getSource(),i=t.getParameter("selected");if(!(e.getMode()==="MultiSelect"&&!i)){this._showDetail(t.getParameter("listItem")||t.getSource())}},onBypassed:function(){this._oList.removeSelections(true)}+
,createGroupHeader:function(t){return new s({title:t.text,upperCase:false})},onNavBack:function(){history.go(-1)},_createViewModel:function(){return new e({isFilterBarVisible:true,filterBarLabel:this.getResourceBundle().getText("listFilterBarText",[this.+
getResourceBundle().getText("OPEN")]),delay:0,title:this.getResourceBundle().getText("listTitleCount",[0]),noDataText:this.getResourceBundle().getText("listListNoDataText"),sortBy:"TradingContract",groupBy:"None",selectedStatus:"OPEN",routParameters:{},i+
sInitialized:false})},_onMasterMatched:function(){this.getModel("appView").setProperty("/layout","OneColumn")},_showDetail:function(t){var e=!o.system.phone;this.getModel("appView").setProperty("/layout","TwoColumnsMidExpanded");this.getRouter().navTo("o+
bject",{TradingContract:t.getBindingContext().getProperty("TradingContract"),AbdNumber:t.getBindingContext().getProperty("AbdNumber"),AbdItem:t.getBindingContext().getProperty("AbdItem")},e)},_updateListItemCount:function(t){var e;if(this._oList.getBindi+
ng("items").isLengthFinal()){e=this.getResourceBundle().getText("listTitleCount",[t]);this.getModel("listView").setProperty("/title",e)}},_applyFilterSearch:function(){var t=this._oListFilterState.aSearch.concat(this._oListFilterState.aFilter),e=this.get+
Model("listView");this._oList.getBinding("items").filter(t,"Application");if(t.length!==0){e.setProperty("/noDataText",this.getResourceBundle().getText("listListNoDataWithFilterOrSearchText"))}else if(this._oListFilterState.aSearch.length>0){e.setPropert+
y("/noDataText",this.getResourceBundle().getText("listListNoDataText"))}},_updateFilterBar:function(t){var e=this.getModel("listView");e.setProperty("/isFilterBarVisible",this._oListFilterState.aFilter.length>0);e.setProperty("/filterBarLabel",this.getRe+
sourceBundle().getText("listFilterBarText",[t]))}})});                                                                                                                                                                                                         